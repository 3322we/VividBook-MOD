%%% ========== 数学宏包 ==========

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{Macros/Emath}

%% ======== 加载必要宏包 ========
% ------ 公式增强 ------
%\RequirePackage{amsmath,extarrows}
% ------ 数学字符 ------
%\RequirePackage{amssymb,amsfonts,mathrsfs,esint}
%\newcommand\bmmax{0}
%\RequirePackage{bm}
% ------ 微分缩写 ------
\RequirePackage{physics} 
% ------ 定理环境 ------
%RequirePackage{amsthm}
%% ======== 宏包加载完毕 ========

%% ======== 数学运算命令 ========
\let\cmd\newcommand
\let\recmd\renewcommand  
%% ====== 代数命令配置 ======
\RequirePackage{xparse} % 增强自定义命令
% ------ 希腊字母 ------ 
\recmd{\a}{\alpha}
\recmd{\b}{\beta}
\recmd{\d}{\delta}
\cmd{\DD}{\Delta}
\cmd{\g}{\gamma}
\cmd{\G}{\Gamma}
\cmd{\e}{\varepsilon}
\cmd{\z}{\zeta}
\recmd{\i}{\eta}
\recmd{\t}{\theta}
\recmd{\l}{\lambda}
\recmd{\L}{\Lambda}
\recmd{\r}{\rho}
\recmd{\u}{\upsilon}
% ------ 拉丁字母变体 ------ 
\cmd{\A}{\mathcal{A}}
\cmd{\B}{\mathcal{B}}
\cmd{\C}{\mathcal{C}}
\cmd{\D}{\mathcal{D}}
\cmd{\E}{\mathcal{E}}
\cmd{\F}{\mathcal{F}}
\recmd{\L}{\mathcal{L}}
\cmd{\M}{\mathcal{M}}
\cmd{\N}{\mathcal{N}}
\recmd{\O}{\mathcal{O}}
\recmd{\P}{\mathcal{P}}
\cmd{\Q}{\mathcal{Q}}
\cmd{\R}{\mathcal{R}}
\recmd{\S}{\mathcal{S}}
\cmd{\T}{\mathcal{T}}
\cmd{\U}{\mathcal{U}}
\cmd{\V}{\mathcal{V}}
%-----------------
\recmd{\aa}{\mathbf{a}}
\cmd{\bb}{\mathbf{b}}
\cmd{\cc}{\mathbf{c}}
\cmd{\ee}{\mathrm{e}}
\cmd{\ebf}{\mathbf{e}}
\cmd{\ff}{\mathbf{f}}
\recmd{\gg}{\mathbf{g}}
\cmd{\hh}{\mathbf{h}}
\cmd{\ii}{\mathrm{i}}
\cmd{\ibf}{\mathbf{i}}
\cmd{\jj}{\mathbf{j}}
\cmd{\kk}{\mathbf{k}}
\recmd{\ll}{\mathbf{l}}
\cmd{\pp}{\mathbf{p}}
\recmd{\qq}{\mathbf{q}}
\cmd{\rr}{\mathbf{r}}
\recmd{\ss}{\mathbf{s}}
\recmd{\tt}{\mathbf{t}}
\cmd{\uu}{\mathbf{u}}
\cmd{\vv}{\mathbf{v}}
\cmd{\ww}{\mathbf{w}}
\cmd{\xx}{\mathbf{x}}
\cmd{\yy}{\mathbf{y}}
\cmd{\zz}{\mathbf{z}}
%-----------------
\cmd{\st}{\mathrm{s.t.}}
\recmd{\ae}{\mathrm{a.e.}}
%-----------------
\cmd{\FF}{\mathbf{F}}
\cmd{\NN}{\mathbb{N}}
\cmd{\Nbf}{\mathbf{N}}
\cmd{\OO}{\mathbf{O}}
\cmd{\PP}{\mathbf{P}}
\cmd{\ZZ}{\mathbb{Z}}
\cmd{\Qbf}{\mathbf{Q}}
\cmd{\QQ}{\mathbb{Q}}
\cmd{\Rbf}{\mathbf{R}}
\cmd{\RR}{\mathbb{R}}
\cmd{\CC}{\mathbb{C}}
% ------ 关系 ------ 
\cmd{\defeq}{\triangleq}
\cmd{\eqv}{\Leftrightarrow}
\cmd{\Eqv}{\Longleftrightarrow}
% ------ 数列 ------ 
\NewDocumentCommand{\seq}{ m m o o }{%
    \left( #1_{#2} \right)% 先输出 (a_n) 部分
    % 检测是否有起始值 [1]
    \IfValueT{#3}{%
        _{#2=#3}% 输出下标 n=1
    }%
    % 检测是否有终止值 [\infty]
    \IfValueT{#4}{%
        ^{#4}% 输出上标 \infty
    }%
}
% ------ 计数 ------ 
\NewDocumentCommand{\pass}{ m O{1} G{n} }{%
    #1_{#2}, \cdots, #1_{#3}
}
\NewDocumentCommand{\num}{ O{1} G{n} }{%
    #1, \cdots, #2
}
% ------ 求和 ------ 
\let\oldsum\sum

\cmd{\isum}{
\sum_{i=1}^{\infty}
}
\cmd{\jsum}{
\sum_{j=1}^{\infty}
}
\cmd{\ksum}{
\sum_{k=1}^{\infty}
}
\cmd{\lsum}{
\sum_{l=1}^{\infty}
}
\cmd{\msum}{
\sum_{m=1}^{\infty}
}
\cmd{\nsum}{
\sum_{n=1}^{\infty}
}

% sum 重定义
%\RenewDocumentCommand{\sum}{g O{} O{}}{%
%    \IfValueTF{#1}{%
%        \oldsum_{%
%            #1%
            % 这里的 #2 是 O 参数，默认就是空，所以只需判断是不是空即可
%            \if\relax\detokenize{#2}\relax
%            \else
%                = #2%
%            \fi
%        }^{#3}%
%    }{ \oldsum }%
    %
%}
% ------ 多项式 ------ 
\NewDocumentCommand{\polynom}{O{n} m g}{
#2_{#1} \IfValueTF{#3}{#3}{x}^{#1} +\cdots + #2_1 \IfValueTF{#3}{#3}{x} + #2_0
}
% ------ 幂级数 ------ 
\NewDocumentCommand{\power}{O{n} m g}{
\sum_{#1=0}^{\infty} #2_{#1} \IfValueTF{#3}{#3}{x}^{#1} 
}

%% ====== 分析学命令配置 ======
% ------ 极限 ------ 
\let\oldlim\lim
\let\oldint\int
\let\oldiint\iint
\let\oldiiint\iiint
\let\oldoint\oint
\let\oldoiint\oiint

\cmd{\oo}{\infty}

% 重定义\lim, 注意:不含有取极限的函数
%\RenewDocumentCommand{\lim}{ g O{}}{%
%    \IfValueTF{#1}{%
%        \oldlim_{%
%            #1%
            % 这里的 #2 是 O 参数，默认就是空，所以只需判断是不是空即可
%            \if\relax\detokenize{#2}\relax
%            \else
%                \to #2%
%            \fi
%        }%
%    }{ \oldlim }%
    %
%}

% 数列极限, 注意:不含有取极限的函数
\newcommand{\nlim}{
\lim_{n\to \infty}
}
\newcommand{\mlim}{
\lim_{m\to \infty}
}
\newcommand{\klim}{
\lim_{k\to \infty}
}

% 函数极限, 注意:不含有取极限的函数
\newcommand{\xlim}[1]{
\lim_{x\to #1}
}
\newcommand{\ylim}[1]{
\lim_{y\to #1}
}
\newcommand{\zlim}[1]{
\lim_{z\to #1}
}
\newcommand{\tlim}[1]{
\lim_{t\to #1}
}
\newcommand{\hlim}[1]{
\lim_{h\to #1}
}
\newcommand{\llim}[1]{
\lim_{l\to #1}
}
% ------ 微分 ------ 
% Talyor展开
\NewDocumentCommand{\taylorsum}{O{n} m O{x} g}{
#2(\IfValueTF{#4}{#4}{x_0})+
\frac{#2^\prime(\IfValueTF{#4}{#4}{x_0})}{1!}(#3-\IfValueTF{#4}{#4}{x_0})+
\cdots+\frac{#2^{(#1)}(#3-\IfValueTF{#4}{#4}{x_0})}{(#1) !}(#3-\IfValueTF{#4}{#4}{x_0})^{#1}
}
% Taylor级数
\NewDocumentCommand{\taylorseries}{O{n} m O{x} g}{
\sum_{n=0}^{\infty}\frac{#2^{(#1)}(#3-\IfValueTF{#4}{#4}{x_0})}{(#1) !}(#3-\IfValueTF{#4}{#4}{x_0})^{#1}
}
% ------ 积分 ------ 
% 重定义\int
%\RenewDocumentCommand{\int}{ O{} O{} g g }{%
%    \oldint_{#1}^{#2} % 先输出积分号和函数
%    \IfValueT{#3}{%   % 检测 #3 是否存在 (If Value True)
%        #3       % 如果存在，输出 #3
%    }
%    \IfValueT{#4}{%   % 检测 #4 是否存在 (If Value True)
%        \dd{#4}       % 如果存在，输出 dx (这里用了 physics 的 \dd)
        % 如果没用 physics 宏包，上一行改成: \, \mathrm{d}#4
%    }%
%}

% 重定义\iint
%\RenewDocumentCommand{\iint}{ O{} g g g }{%
%    \oldiint_{#1} % 先输出积分号和函数
%    \IfValueT{#2}{%   % 检测 #3 是否存在 (If Value True)
%        #2       % 如果存在，输出 #3
%    }
%    \IfValueT{#3}{%   % 检测 #4 是否存在 (If Value True)
%        \dd{#3}       % 如果存在，输出 dx (这里用了 physics 的 \dd)
%    }
%    \IfValueT{#4}{%   % 检测 #4 是否存在 (If Value True)
%        \dd{#4}       % 如果存在，输出 dx (这里用了 physics 的 \dd)
%    }%
%}

% 重定义\oint, 注意,不含有被积函数和积分变量
%\RenewDocumentCommand{\oint}{ O{}}{%
%    \oldoint_{#1} % 先输出积分号和函数
%}

% 重定义\oiint, 注意,不含有被积函数和积分变量
%\RenewDocumentCommand{\oiint}{ O{}}{%
%    \oldoiint_{#1} % 先输出积分号和函数
%}

% 重定义\iiint
%\RenewDocumentCommand{\iiint}{ O{} g g g g}{%
%    \oldiiint_{#1} % 先输出积分号和函数
%    \IfValueT{#2}{%   % 检测 #3 是否存在 (If Value True)
%        #2       % 如果存在，输出 #3
%    }
%    \IfValueT{#3}{%   % 检测 #4 是否存在 (If Value True)
%        \dd{#3}       % 如果存在，输出 dx (这里用了 physics 的 \dd)
%    }
%    \IfValueT{#4}{%   % 检测 #4 是否存在 (If Value True)
%        \dd{#4}       % 如果存在，输出 dx (这里用了 physics 的 \dd)
%    }
%    \IfValueT{#5}{%   % 检测 #4 是否存在 (If Value True)
%        \dd{#5}       % 如果存在，输出 dx (这里用了 physics 的 \dd)
%    }%
%}

%% ======== 数学运算命令定义完毕 ========

\endinput
